## 项目笔记

### **1.创建vue项目**

```shell
vue create management
```

### **2.创建git仓库**

```shell
git init
git remote add origin https://github.com/zengbin13/management.git
git checkout -b dev
git checkout -b feature-Vuemanagement-V1.0.0-20200414
git add .
git commit -m "初始化项目"
git push
```

### **3.vue.config.js**

```js
const path = require("path");

module.exports = {
  // 部署应用包时的基本 URL,用法和 webpack 本身的 output.publicPath 一致
  publicPath: "/",
  // 输出文件目录
  outputDir: "dist",
  // eslint-loader 是否在保存的时候检查
  lintOnSave: false,
  // 是否使用包含运行时编译器的 Vue 构建版本
  runtimeCompiler: false,
  // 生产环境是否生成 sourceMap 文件
  productionSourceMap: false,
  // 生成的 HTML 中的 <link rel="stylesheet"> 和 <script> 标签上启用 Subresource Integrity (SRI)
  integrity: false,
  // webpack相关配置
  chainWebpack: config => {
    //别名解析
    config.resolve.alias
      .set("vue$", "vue/dist/vue.esm.js")
      .set("@", path.resolve(__dirname, "./src"));
    //svg文件解析配置
    const svgRule = config.module.rule("svg");
    svgRule.uses.clear();
    svgRule
      .use("svg-sprite-loader")
      .loader("svg-sprite-loader")
      .options({
        symbolId: "icon-[name]",
        include: ["./src/icons"]
      });
  },
  configureWebpack: config => {
    if (process.env.NODE_ENV === "production") {
      // 生产环境
      config.mode = "production";
    } else {
      // 开发环境
      config.mode = "development";
    }
  },
  // css相关配置
  css: {
    // 是否分离css（插件ExtractTextPlugin）
    extract: true,
    // 是否开启 CSS source maps
    sourceMap: false,
    // css预设器配置项
    loaderOptions: {
    },
    // 是否启用 CSS modules for all css / pre-processor files.
    requireModuleExtension: true
  },
  // 是否使用 thread-loader
  parallel: require("os").cpus().length > 1,
  // PWA 插件相关配置
  pwa: {},
  // webpack-dev-server 相关配置
  devServer: {
    open: false, // 编译完成是否打开网页
    host: "0.0.0.0", // 指定使用地址，默认localhost,0.0.0.0代表可以被外界访问
    port: 8080, // 访问端口
    https: false, // 编译失败时刷新页面
    hot: true, // 开启热加载
    hotOnly: false,
    proxy: null, // 设置代理
    overlay: {
      // 全屏模式下是否显示脚本错误
      warnings: true,
      errors: true
    },
    before: app => {}
  },
  // 第三方插件配置
  pluginOptions: {
    
  }
};
```

### **4.创建样式文件夹 styles**

```js
//vuw.config.js
css: {
    // 是否分离css（插件ExtractTextPlugin）
    extract: true,
    // 是否开启 CSS source maps
    sourceMap: false,
    // css预设器配置项
    loaderOptions: {
      sass: {
        prependData: `@import "./src/styles/main.scss";`
      }
    },
    // 是否启用 CSS modules for all css / pre-processor files.
    requireModuleExtension: true
  },
```

```scss
//config.scss
// 主题颜色
$bgColor: #00d2d3;

// 常用样式
.pull-left {
  float: left;
}
```

### **5.重置浏览器样式**

```shell
npm install normalize.css -D
```

```js
//main.js
import "normalize.css";
```

### 6.引入element UI框架

```shell
npm install element-ui -S
```

```js
//main.js
import ElementUI from 'element-ui';
import 'element-ui/lib/theme-chalk/index.css';
Vue.use(ElementUI);
```

### 7.使用postcss-pxtorem适配

```shell
npm install postcss-pxtorem -D
```

```js
//postcss.config.js
module.exports = {
  plugins: {
    "postcss-pxtorem": {
      rootValue: 16, //表示根元素的字体大小  设计稿1920px 页面换算为120rem
      unitPrecision: 5, //rem的精度
      propList: ["*"], //能够转换的css属性
      selectorBlackList: [], //以选择器忽略转换的名单
    }
  }
};
```

```js
//utils/setRem.js
//1.设计稿1rem的宽度
const baseSize = 16;
//2.setrem 函数
function setRem() {
  //2.1获取浏览器的窗口宽度
  const htmlWidth =
    document.documentElement.clientWidth || document.body.clientWidth;
  //2.2 实际设备页面宽度和 设计稿 的比值
  const scale = htmlWidth / 1920;
  //2.3设置根元素字体大小
  document.querySelector("html").style.fontSize = baseSize * scale + "px";
}
//3.初始化
setRem();
//4.监听浏览器窗口变化
window.addEventListener("resize", () => {
  setRem();
});
```

```js
//main.js
```

### 8.login页面的UI

1. 对*.el-form-item__label*样式重置时，不能使用 scoped,否则样式不能生效
2. el-form表单验证函数，使用prop匹配

### 9.表单验证规则

```js
//utils/validate.js
//过滤特殊字符串
stripscript(str) {
    let pattern = new RegExp("[`~ !@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）&%;—|{}【】‘；：”“'。，、？]")
    let resultStr =""
    for(let value of str) {
        resultStr = resultStr + value.replace(pattern, "")
    }
    return resultStr
}
//验证邮箱格式
export function validateMailFormat(str) {
  let reg = /^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;
  return reg.test(str);
}
```

### 10.封装ajax请求对象

```shell
npm install axios -D
```

```js
//utils/request.js
//1.导入axios
import axios from "axios";
//2.创建实例
const service = axios.create({
  //存在跨域问题
  baseURL: "http://www.web-jshtml.cn/productapi/token",
  timeout: 5000,
});
//3.添加请求和响应拦截器
service.interceptors.request.use(
  (config) => {
    //请求之前的数据处理
    return config;
  },
  (error) => {
    //请求出错的处理
    return Promise.reject(error);
  }
);
service.interceptors.response.use(
  (response) => {
    // 对响应数据做点什么
    return response;
  },
  (error) => {
    // 对响应错误做点什么
    return Promise.reject(error);
  }
);
//导出封装的axios
export default service;
```

### 11.login页面的请求api

![1581906927117](C:\Users\yu13\AppData\Roaming\Typora\typora-user-images\1581906927117.png)

```js
//api/login.js
import service from "../utils/request";
//接口名称：登录获取验证码
export function GetCheckCode(data) {
  return service.request({
    url: "/getSms/",
    method: "POST",
    data
  });
}
```

### 12.代理跨域的处理

- 使用环境变量配置BASEURL

```js
//utils/request.js
const BASEURL = process.env.NODE_ENV === "prodution" ? "" : "/api"
```

- 利用node.js创建一个本地服务器进行代理

```js
//vue.config.js
devServer: {
    proxy: {
      ///api开头的接口，代理访问规则
      "/api": {
        target: "http://www.web-jshtml.cn/productapi", //代理的域名
        changeOrigin: true, //是否启用代理
        pathRewrite: {  //重写请求
          "^/api": ""
        }
      }
    },
}
```

- 以请求 `/getSms`为例
  - 生产环境， baseURL为 `/api`, url为 `/api/getSms`
  - 以 `/api`开头符合代理规则，代理路径将为 `http://www.web-jshtml.cn/productapi/api/getSms`
  - 但是url为 `/api/getSms`符合重写规则 `/api`开头 ，url为 `/getSms`
  - 最终代理url为 `http://www.web-jshtml.cn/productapi/getSms`

### 13.响应拦截器对resCode处理

```js
//utils/request.js

//0.使用element的消息提示
import { Message } from "element-ui";

service.interceptors.response.use(
  (response) => {
    //对响应错误码进行判断，错误码使用message通知
    let data = response.data;
    if (data.resCode !== 0) {
      Message({
        showClose: true,
        message: data.message,
        type: "error",
      });
      return Promise.reject(error);
    } else {
      Message({
        showClose: true,
        message: data.message,
        type: "success",
      });
      return response;
    }
  })
```

### 14.根据测试用例完善login页面功能

![1586955568243](C:\Users\yu13\AppData\Roaming\Typora\typora-user-images\1586955568243.png)

### 15.sha1/md5 密码进行加密

```shell
npm install js-sha1 --save
```

```js
import sha1 from "js-sha1"
//对登录、注册请求中的密码进行加密
sha1(data.password)
```

